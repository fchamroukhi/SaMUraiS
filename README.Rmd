---
output: github_document
bibliography: bibliography.bib
csl: chicago-author-date.csl
nocite: '@*'
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.align = "center",
  fig.path = "man/figures/README-"
)
```
<html><p align="center"><img  align="middle" src="./media/samurais-bel.jpg" alt="SaMUraiS" width="200"/></p></html>

# **SaMUraiS**: **S**t**A**tistical **M**odels for the **U**nsupe**R**vised segment**A**t**I**on of time-**S**eries

<!-- badges: start -->
[![Travis build status](https://travis-ci.org/fchamroukhi/SaMUraiS.svg?branch=master)](https://travis-ci.org/fchamroukhi/SaMUraiS)
<!-- badges: end -->

samurais is an open source toolbox including many original and flexible user-friendly 
statistical latent variable models and unsupervised algorithms to segment and 
represent, time-series data (univariate or multivariate), and more generally, 
longitudinal data which include regime changes.

Our samurais use mainly the following efficient "sword" packages to segment 
data:

* RHLP;
* HMM/HMMR;
* PWR;
* MRHLP;
* MHMMR.

The models and algorithms are developed and written in Matlab by Faicel 
Chamroukhi, and translated and designed into R packages by Florian Lecocq, 
Marius Bartcus and Faicel Chamroukhi.

# Installation

You can install the **samurais** package from [GitHub](https://github.com/fchamroukhi/SaMUraiS) with:

```{r, eval = FALSE}
# install.packages("devtools")
devtools::install_github("fchamroukhi/SaMUraiS")
```

To build *vignettes* for examples of usage, type the command below instead:

```{r, eval = FALSE}
# install.packages("devtools")
devtools::install_github("fchamroukhi/SaMUraiS", 
                         build_opts = c("--no-resave-data", "--no-manual"), 
                         build_vignettes = TRUE)
```

Use the following command to display vignettes:

```{r, eval = FALSE}
browseVignettes("samurais")
```

# Usage

<details>
  <summary>RHLP</summary>

```{r, message = FALSE}
library(samurais)

data("univtoydataset")

K <- 5 # Number of regimes (mixture components)
p <- 3 # Dimension of beta (order of the polynomial regressors)
q <- 1 # Dimension of w (order of the logistic regression: to be set to 1 for segmentation)
variance_type <- "heteroskedastic" # "heteroskedastic" or "homoskedastic" model

n_tries <- 1
max_iter = 1500
threshold <- 1e-6
verbose <- TRUE
verbose_IRLS <- FALSE

rhlp <- emRHLP(univtoydataset$x, univtoydataset$y, K, p, q, 
               variance_type, n_tries, max_iter, threshold, 
               verbose, verbose_IRLS)

rhlp$summary()

rhlp$plot()
```

</details>

<br />

<details>
  <summary>HMMR</summary>

```{r, message = FALSE}
library(samurais)

data("univtoydataset")

K <- 5 # Number of regimes (states)
p <- 3 # Dimension of beta (order of the polynomial regressors)
variance_type <- "heteroskedastic" # "heteroskedastic" or "homoskedastic" model

n_tries <- 1
max_iter <- 1500
threshold <- 1e-6
verbose <- TRUE

hmmr <- emHMMR(univtoydataset$x, univtoydataset$y, K, p, variance_type, 
               n_tries, max_iter, threshold, verbose)

hmmr$summary()

hmmr$plot()
```

</details>

<br />

<details>
  <summary>PWR</summary>

```{r, message = FALSE}
library(samurais)

data("univtoydataset")

K <- 5 # Number of segments
p <- 3 # Polynomial degree

pwr <- fitPWRFisher(univtoydataset$x, univtoydataset$y, K, p)

pwr$plot()
```

</details>

<br />

<details>
<summary>MRHLP</summary>

```{r, message = FALSE}
library(samurais)

data("multivtoydataset")

K <- 5 # Number of regimes (mixture components)
p <- 3 # Dimension of beta (order of the polynomial regressors)
q <- 1 # Dimension of w (order of the logistic regression: to be set to 1 for segmentation)
variance_type <- "heteroskedastic" # "heteroskedastic" or "homoskedastic" model

n_tries <- 1
max_iter <- 1500
threshold <- 1e-6
verbose <- TRUE
verbose_IRLS <- FALSE

mrhlp <- emMRHLP(multivtoydataset$x, multivtoydataset[,c("y1", "y2", "y3")], 
                 K, p, q, variance_type, n_tries, max_iter, threshold, verbose,
                 verbose_IRLS)

mrhlp$summary()

mrhlp$plot()
```

</details>

<br />

<details>
  <summary>MHMMR</summary>

```{r, message = FALSE}
library(samurais)

data("multivtoydataset")

K <- 5 # Number of regimes (states)
p <- 3 # Dimension of beta (order of the polynomial regressors)
variance_type <- "heteroskedastic" # "heteroskedastic" or "homoskedastic" model

n_tries <- 1
max_iter <- 1500
threshold <- 1e-6
verbose <- TRUE

mhmmr <- emMHMMR(multivtoydataset$x, multivtoydataset[, c("y1", "y2", "y3")],
                 K, p, variance_type, n_tries, max_iter, threshold, verbose)

mhmmr$summary()

mhmmr$plot()
```

</details>

# References
